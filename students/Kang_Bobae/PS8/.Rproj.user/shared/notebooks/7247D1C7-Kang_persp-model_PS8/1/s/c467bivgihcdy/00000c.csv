"0","# a decision tree"
"0","mhealth_tree <- tree(vote96 ~ .,"
"0","                     data = mhealth_train,"
"0","                     control = tree.control(nobs = nrow(mhealth_train), mindev = .001))"
"0","# 10-fold CV trees to find best tree"
"0","mhealth_cv <- mhealth_train %>%"
"0","  crossv_kfold(k = 10) %>%"
"0","  mutate(tree = map(train, ~ tree(vote96 ~ ., data = .,"
"0","    control = tree.control(nobs = nrow(mhealth_train), mindev = .001))))"
"0","# calculate each possible prune result for each fold"
"0","mhealth_cv <-"
"0","  expand.grid(mhealth_cv$.id,"
"0","              seq(from = 2, to = 10)) %>%"
"0","  as_tibble() %>%"
"0","  mutate(Var2 = as.numeric(Var2)) %>%"
"0","  rename(.id = Var1,"
"0","         k = Var2) %>%"
"0","  left_join(mhealth_cv) %>%"
"0","  mutate(prune = map2(tree, k, ~ prune.misclass(.x, best = .y)),"
"0","         mse = map2_dbl(prune, test, err.rate.tree)) %>%"
"0","  group_by(k) %>%"
"0","  summarize(test_mse = mean(mse),"
"0","            sd = sd(mse, na.rm = TRUE))"
"0","mhealth_tree_pruned <- prune.tree(mhealth_tree, best = 5)"
"0","summary(mhealth_tree_pruned)"
"1","
Classification tree:
"
"1","snip.tree(tree = mhealth_tree, nodes = c(10L, 11L, 9L, 3L))
"
"1","Variables actually used in tree construction:
"
"1","[1]"
"1"," ""mhealth_sum"""
"1"," ""age""        "
"1"," ""educ""       "
"1"," ""inc10""      "
"1","
"
"1","Number of terminal nodes:  5 
"
"1","Residual mean deviance:  1.073 = 870 / 811 
"
"1","Misclassification error rate:"
"1"," "
"1","0.2659"
"1"," "
"1","="
"1"," "
"1","217"
"1"," "
"1","/"
"1"," "
"1","816"
"1"," "
"1","
"
